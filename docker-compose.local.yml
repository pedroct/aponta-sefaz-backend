# Docker Compose para Desenvolvimento Local
# Conecta à mesma rede e banco de dados do ambiente de produção
#
# IMPORTANTE: O container postgres-aponta deve estar rodando antes de usar este compose
# Para iniciar: docker compose up -d postgres (no docker-compose.yml principal)

services:
  # API FastAPI - Desenvolvimento Local
  api-local:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: api-aponta-local
    restart: unless-stopped
    ports:
      - "8000:8000"
    env_file:
      - .env
    environment:
      - ENVIRONMENT=development
      - API_DEBUG=true
      - DATABASE_HOST=host.docker.internal  # Windows host (PostgreSQL fora do compose)
      - DATABASE_URL=postgresql://${DATABASE_USER:-aponta_user}:${DATABASE_PASSWORD:-aponta_secret_password}@host.docker.internal:5432/${DATABASE_NAME:-gestao_projetos}
      - TZ=America/Fortaleza
    networks:
      - api-aponta_aponta-network

# Usa a rede externa já criada pelo docker-compose.yml principal
networks:
  api-aponta_aponta-network:
    external: true

# Usa o banco postgres-aponta já existente no docker-compose.yml principal
